# Feature Specification: 账单明细管理

**Feature Branch**: `001-bill-management`
**Created**: 2025-12-30
**Status**: Draft
**Input**: 用户描述: "这是一个C端项目,兼容PC端和H5端.可以让用户增删改查账单明细(包含金额,日期,备注,货币类型,账单类型等).并且能够根据用户填写的账单明细用统计报表展示"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 新增账单明细 (Priority: P1)

用户需要快速记录一笔新的收入或支出，包括金额、日期、备注、货币类型和账单类型等信息。

**Why this priority**: 新增账单是整个应用的核心功能，没有账单数据就无法进行后续的查看、编辑和统计分析。这是用户使用产品的第一步。

**Independent Test**: 可以通过创建一笔新账单并验证其出现在账单列表中来独立测试。用户能够完成"记一笔账"的基本操作即可交付价值。

**Acceptance Scenarios**:

1. **Given** 用户已登录并进入账单页面, **When** 用户点击"新增账单"按钮并填写金额(100)、日期(今天)、账单类型(餐饮)、货币类型(CNY), **Then** 系统保存账单并在列表中显示该条记录
2. **Given** 用户正在填写新账单, **When** 用户不填写必填字段(金额)并提交, **Then** 系统提示"请填写金额"且不保存账单
3. **Given** 用户正在填写新账单, **When** 用户填写负数金额, **Then** 系统提示"金额必须大于0"
4. **Given** 用户在H5端记账, **When** 用户完成账单填写, **Then** 账单在PC端同样可见且数据一致

---

### User Story 2 - 查看账单列表 (Priority: P1)

用户需要查看自己记录的所有账单明细，支持按时间范围和账单类型筛选。

**Why this priority**: 查看账单与新增账单同等重要，用户需要随时回顾自己的收支情况，这是进行财务管理的基础。

**Independent Test**: 可以在有预置账单数据的情况下，验证用户能否正确查看和筛选账单列表。

**Acceptance Scenarios**:

1. **Given** 用户有10笔账单记录, **When** 用户进入账单列表页面, **Then** 系统按时间倒序展示所有账单，每条显示金额、日期、类型、备注
2. **Given** 用户有多笔不同月份的账单, **When** 用户选择筛选"本月"账单, **Then** 只显示当月的账单记录
3. **Given** 用户有多种类型的账单, **When** 用户选择筛选"餐饮"类型, **Then** 只显示餐饮类型的账单记录
4. **Given** 用户在PC端查看列表, **When** 屏幕宽度足够, **Then** 以表格形式展示更多信息列
5. **Given** 用户在H5端查看列表, **When** 屏幕宽度有限, **Then** 以卡片形式展示账单，信息适配移动端

---

### User Story 3 - 编辑账单明细 (Priority: P2)

用户需要修改已记录的账单信息，比如更正金额、修改日期或补充备注。

**Why this priority**: 用户可能会输入错误或需要补充信息，编辑功能确保数据的准确性。在有了新增和查看功能后，编辑是自然的延伸。

**Independent Test**: 可以通过修改一条已有账单的某个字段，验证修改后的数据正确保存并显示。

**Acceptance Scenarios**:

1. **Given** 用户查看账单列表, **When** 用户点击某条账单的"编辑"按钮, **Then** 进入编辑页面，所有字段预填充当前值
2. **Given** 用户正在编辑账单, **When** 用户修改金额从100改为150并保存, **Then** 账单列表中该条记录显示新金额150
3. **Given** 用户正在编辑账单, **When** 用户点击"取消", **Then** 返回列表页，账单数据未发生变化

---

### User Story 4 - 删除账单明细 (Priority: P2)

用户需要删除错误或不需要的账单记录。

**Why this priority**: 删除是数据管理的必要功能，但优先级低于新增、查看、编辑，因为用户删除账单的频率相对较低。

**Independent Test**: 可以通过删除一条账单并验证其从列表中消失来独立测试。

**Acceptance Scenarios**:

1. **Given** 用户查看账单列表, **When** 用户点击某条账单的"删除"按钮, **Then** 系统弹出确认对话框"确定要删除这条账单吗？"
2. **Given** 用户看到删除确认对话框, **When** 用户点击"确定", **Then** 账单被删除，列表刷新后不再显示该条记录
3. **Given** 用户看到删除确认对话框, **When** 用户点击"取消", **Then** 对话框关闭，账单保留不变

---

### User Story 5 - 统计报表展示 (Priority: P3)

用户需要通过可视化图表了解自己的收支情况，包括按类型、按时间的统计分析。

**Why this priority**: 统计报表是数据价值的体现，但依赖于有足够的账单数据。在基础CRUD功能完善后，报表功能能够提升用户体验和产品价值。

**Independent Test**: 可以在有预置账单数据的情况下，验证统计图表是否正确展示汇总数据。

**Acceptance Scenarios**:

1. **Given** 用户有本月的多笔账单, **When** 用户进入统计报表页面, **Then** 系统显示本月总收入、总支出、结余金额
2. **Given** 用户有多种类型的支出账单, **When** 用户查看支出分类统计, **Then** 系统以饼图形式展示各类型支出占比
3. **Given** 用户有多月的账单数据, **When** 用户查看月度趋势, **Then** 系统以折线图或柱状图展示各月收支趋势
4. **Given** 用户有不同货币类型的账单, **When** 用户查看统计报表, **Then** 系统按货币类型分别统计，不混合计算

---

### Edge Cases

- 用户没有任何账单记录时，列表和报表页面应显示空状态提示，引导用户添加第一笔账单
- 用户输入超长备注(超过500字符)时，系统应进行长度限制或截断提示
- 用户在弱网环境下保存账单时，应有加载状态提示，保存失败时显示错误信息并保留用户输入
- 用户同时在PC端和H5端操作同一账单时，后保存的操作应覆盖先前的，或提示数据冲突
- 用户选择未来日期记账时，系统应允许（预记账场景）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须支持用户创建账单明细，包含以下字段：金额(必填)、日期(必填)、账单类型(必填)、货币类型(必填)、备注(选填)
- **FR-002**: 系统必须支持用户查看账单列表，按时间倒序排列
- **FR-003**: 系统必须支持按时间范围(本日、本周、本月、本年、自定义范围)筛选账单
- **FR-004**: 系统必须支持按账单类型筛选账单
- **FR-005**: 系统必须支持用户编辑已有账单的所有字段
- **FR-006**: 系统必须支持用户删除账单，删除前需要用户确认
- **FR-007**: 系统必须在统计报表中展示选定时间范围内的总收入、总支出、结余
- **FR-008**: 系统必须以饼图形式展示支出分类占比
- **FR-009**: 系统必须以折线图或柱状图展示收支趋势
- **FR-010**: 系统必须在PC端和H5端提供一致的功能，界面适配不同屏幕尺寸
- **FR-011**: 系统必须对不同货币类型的账单分别统计，不混合计算
- **FR-012**: 系统必须对金额字段进行校验，只接受大于0的数值
- **FR-013**: 系统必须对必填字段进行校验，未填写时给出明确提示

### Key Entities

- **账单明细(Bill)**: 用户记录的一笔收入或支出，包含金额、日期、账单类型、货币类型、备注、创建时间、更新时间
- **账单类型(BillType)**: 账单的分类，如餐饮、交通、购物、工资、奖金等，分为收入类型和支出类型
- **货币类型(Currency)**: 账单金额的货币单位，如CNY(人民币)、USD(美元)、EUR(欧元)等
- **用户(User)**: 使用系统的个人用户，拥有自己的账单数据

## Assumptions

- 用户已完成注册和登录，本规范不涉及用户认证功能
- 账单类型列表预设常用类型，暂不支持用户自定义类型
- 货币类型列表预设常用货币，暂不涉及汇率换算功能
- 统计报表暂不支持导出功能
- 账单数据仅对账单所有者可见，不涉及共享或协作功能
- 系统采用标准的Web响应式设计适配PC和H5端，不开发独立的移动App

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户在30秒内完成一笔新账单的录入(从点击新增到保存成功)
- **SC-002**: 账单列表加载时间不超过2秒(100条账单以内)
- **SC-003**: 用户能在3次点击内找到任意历史账单(通过筛选功能)
- **SC-004**: 统计报表页面加载时间不超过3秒(1年内数据)
- **SC-005**: PC端和H5端功能一致性达到100%(所有功能在两端均可使用)
- **SC-006**: 用户首次使用无需培训即可完成基本记账操作(可用性测试通过率>90%)
- **SC-007**: 数据同步延迟不超过5秒(跨端操作场景)
